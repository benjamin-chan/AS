1                                                          The SAS System                               10:36 Thursday, June 1, 2017

NOTE: Copyright (c) 2002-2012 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.4 (TS1M1) 
      Licensed to UNIVERSITY OF ALABAMA AT BIRMINGHAM - SFA - T&R, Site 70058223.
NOTE: This session is executing on the W32_ES08R2  platform.



NOTE: Updated analytical products:
      
      SAS/STAT 13.1
      SAS/ETS 13.1
      SAS/OR 13.1
      SAS/IML 13.1
      SAS/QC 13.1

NOTE: Additional host information:

 W32_ES08R2 WIN 6.1.7601 Service Pack 1 Server

--- PEER News and Updates ---

: SECURITY REMINDER :
Please remember not to copy any data files that contain PHI (protected health identifiers) to any of the shared folders.

 


NOTE: SAS initialization used:
      real time           0.25 seconds
      cpu time            0.12 seconds
      
1          *  University of Alabama at Birmingham                               *
2          *  AS project                                            *
3          **********************************************************************;
4          options pagesize=74 linesize=150 pageno=1 missing=' ' date FORMCHAR="|----|+|---+=|-/\<>*";
5          * Programmer    : Benjamin Chan <chanb@ohsu.edu>
6          * Creation date :
7          * Modify date   :
8          ;
9          %let cmt=buildExposureFollowUp; * type the name of your program here (without the filename extension);
10         %let pgm=&cmt..sas;
11         %include "lib\libname.sas" ;
NOTE: Libref CCW5STD was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: h:\studies\osteo\data\CDM\5pct\
NOTE: Libref STD_SABR was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: q:\data\std_SABER\
NOTE: Libref MPSTD was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: h:\studies\mpcd\data\stddata\
NOTE: Libref UCBSTD was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: q:\studies\AS\data\stddata\
NOTE: Libref UCB was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: q:\studies\AS\data\UCB\
NOTE: Libref DT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: V:\studies\AS\data
89         footnote "&pgm.";
90         * footnote2 "%sysfunc(datetime(),datetime14.)";
91         title1 '--- AS project ---';
92         **********************************************************************;
93         options macrogen mlogic mprint symbolgen;
94         options nomacrogen nomlogic nomprint nosymbolgen;
95         
96         
97         ods html
98           body = "output\&cmt..html"
99           style = Statistical;
NOTE: Writing HTML Body file: output\buildExposureFollowUp.html
2                                                                   The SAS System                                        10:36 Thursday, June 1, 2017

100        
101        
102        /*
103        See the *Compact Outcome Definition* worksheet in `AS Project Cohort Outcome Codebook-20170410.xlsx`
104         */
105        
106        
107        /*
108        From: Xie, Fenglong [mailto:fenglongxie@uabmc.edu]
109        Sent: Wednesday, May 17, 2017 7:03 AM
110        To: Benjamin Chan <chanb@ohsu.edu>
111        Subject: RE: AS project data
112        
113        Hi, Ben
114        
115        The data are stored at UCB library defined as below email.
116        
117        Attached please find the cohort list.
118        
119        No exclusion was done except excluded for higher level exposure in six month
120        baseline.
121        
122        You need to do appropriate censor (such as censor for discontinues of
123        exposure, switch to same level or higher lever exposure ...).
124        
125        If you have question, please let me know.
126         */
127        
128        
129        proc sql;
130          create table Work.indexLookup as
131            select * from DT.indexLookup
132            order by database, patid, indexDate;
NOTE: Table WORK.INDEXLOOKUP created, with 60010 rows and 13 columns.

133        /*
134        Attach exposure end dates to exposure segments
135         */
136          create table Work.temp0 as
137            select A.database,
138                   A.patid,
139                   A.enr_end_date,
140                   A.death_date,
141                   A.exposure as exposureA,
142                   A.indexDate format = mmddyy10. as indexStartA,
143                   min(B.indexDate - 1, A.enr_end_date, A.death_date) format = mmddyy10. as indexEndA,
144                   B.exposure as exposureB,
145                   B.indexDate format = mmddyy10. as indexStartB
146            from Work.indexLookup A left join
147                 Work.indexLookup B on (A.database = B.database &
148                                        A.patid = B.patid &
149                                        A.indexDate < B.indexDate);
NOTE: Table WORK.TEMP0 created, with 71797 rows and 9 columns.

150          create table Work.tempLookup as
151            select database,
152                   patid,
153                   indexStartA,
154                   min(indexEndA) as earliestIndexEndA
155            from Work.temp0
156            group by database,
157                     patid,
158                     indexStartA;
NOTE: Table WORK.TEMPLOOKUP created, with 59836 rows and 4 columns.

159          create table Work.tempExposureSegments as
160            select A.database,
161                   A.patid,
162                   A.enr_end_date,
163                   A.death_date,
164                   A.exposureA as exposure,
165                   A.indexStartA as exposureStart,
3                                                                   The SAS System                                        10:36 Thursday, June 1, 2017

166                   A.indexEndA as exposureEnd
167            from Work.temp0 A inner join
168                 Work.tempLookup B on (A.database = B.database &
169                                       A.patid = B.patid &
170                                       A.indexStartA = B.indexStartA &
171                                       A.indexEndA = B.earliestIndexEndA)
172            order by A.database,
173                     A.patid,
174                     A.indexStartA;
NOTE: Table WORK.TEMPEXPOSURESEGMENTS created, with 60252 rows and 7 columns.

175        quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.73 seconds
      cpu time            0.51 seconds
      

176        
177        
178        /*
179        Collapse exposure segments
180        
181        See *Starts and Stops: Processing Episode Data With Beginning and Ending Dates*
182        http://www2.sas.com/proceedings/sugi29/260-29.pdf
183         */
184        data DT.exposureTimeline;
185          set Work.tempExposureSegments;
186          by database patid exposure notsorted;
187          format holdPeriodStart mmddyy10.;
188          drop holdPeriodStart;
189          retain holdPeriodStart;
190          if first.exposure then do;  /* Check the last variable in the BY group */
191            holdPeriodStart = exposureStart;
192          end;
193          if last.exposure then do;  /* Check the last variable in the BY group */
194            exposureStart = holdPeriodStart;
195            output;
196          end;
197        run;

NOTE: There were 60252 observations read from the data set WORK.TEMPEXPOSURESEGMENTS.
NOTE: The data set DT.EXPOSURETIMELINE has 46055 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.13 seconds
      cpu time            0.04 seconds
      

198        proc sql;
199          alter table DT.exposureTimeline add daysExposed numeric;
NOTE: Table DT.EXPOSURETIMELINE has been modified, with 8 columns.
200          update DT.exposureTimeline
201            set daysExposed = exposureEnd - exposureStart + 1;
NOTE: 46055 rows were updated in DT.EXPOSURETIMELINE.

202          alter table DT.exposureTimeline add exposureID numeric;
NOTE: Table DT.EXPOSURETIMELINE has been modified, with 9 columns.
203          update DT.exposureTimeline
204            set exposureID = monotonic();
NOTE: 46055 rows were updated in DT.EXPOSURETIMELINE.

205        quit ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.42 seconds
      cpu time            0.21 seconds
      

206        
207        
208        proc means data = DT.exposureTimeline n sum mean std min q1 median q3 max maxdec = 1;
209          class database exposure;
210          var daysExposed;
211        run;
4                                                                   The SAS System                                        10:36 Thursday, June 1, 2017


                                                                  --- AS project ---                                  10:36 Thursday, June 1, 2017   1

                                                                 The MEANS Procedure

                                                           Analysis Variable : daysExposed 
 
                                                                                                                  Lower                       Upper
   database    exposure              N Obs      N           Sum          Mean       Std Dev       Minimum      Quartile        Median      Quartile
   ------------------------------------------------------------------------------------------------------------------------------------------------
   MPCD        DMARD                   423    423      156022.0         368.8         319.8           1.0         102.0         295.0         551.0

               NSAID or no exposure   2093   2093      969119.0         463.0         385.5           1.0         127.0         375.0         726.0

               TNF                    1108   1108      549883.0         496.3         341.4           1.0         221.0         434.0         742.5

   Marketscan  DMARD                  1813   1813      657448.0         362.6         355.2           1.0          88.0         238.0         527.0

               NSAID or no exposure   8122   8122     3382321.0         416.4         423.8           1.0          85.0         251.0         625.0

               TNF                    4824   4824     2458598.0         509.7         407.4           1.0         169.0         412.0         762.0

   Medicare    DMARD                  4304   4304     3311124.0         769.3         704.8           1.0         207.0         534.0        1146.5

               NSAID or no exposure  18431  18431    14359942.0         779.1         776.9           1.0         182.0         547.0        1127.0

               TNF                    4937   4937     4973067.0        1007.3         785.8           1.0         351.0         805.0        1519.0
   ------------------------------------------------------------------------------------------------------------------------------------------------

                                                          Analysis Variable : daysExposed 
 
                                                database    exposure              N Obs       Maximum
                                                -----------------------------------------------------
                                                MPCD        DMARD                   423        1227.0

                                                            NSAID or no exposure   2093        1278.0

                                                            TNF                    1108        1276.0

                                                Marketscan  DMARD                  1813        1625.0

                                                            NSAID or no exposure   8122        1643.0

                                                            TNF                    4824        1637.0

                                                Medicare    DMARD                  4304        3101.0

                                                            NSAID or no exposure  18431        3104.0

                                                            TNF                    4937        3095.0
                                                -----------------------------------------------------
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
                                                              buildExposureFollowUp.sas
NOTE: There were 46055 observations read from the data set DT.EXPOSURETIMELINE.
NOTE: The PROCEDURE MEANS printed page 1.
NOTE: PROCEDURE MEANS used (Total process time):
      real time           0.10 seconds
      cpu time            0.10 seconds
      

212        
213        
214        ods html close;
NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           1.93 seconds
      cpu time            1.24 seconds
      
