1                                                          The SAS System                            16:50 Friday, September 8, 2017

NOTE: Copyright (c) 2002-2012 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.4 (TS1M1) 
      Licensed to UNIVERSITY OF ALABAMA AT BIRMINGHAM - SFA - T&R, Site 70058223.
NOTE: This session is executing on the W32_ES08R2  platform.



NOTE: Updated analytical products:
      
      SAS/STAT 13.1
      SAS/ETS 13.1
      SAS/OR 13.1
      SAS/IML 13.1
      SAS/QC 13.1

NOTE: Additional host information:

 W32_ES08R2 WIN 6.1.7601 Service Pack 1 Server

--- PEER News and Updates ---

: SECURITY REMINDER :
Please remember not to copy any data files that contain PHI (protected health identifiers) to any of the shared folders.

 


NOTE: SAS initialization used:
      real time           0.18 seconds
      cpu time            0.12 seconds
      
1          *  University of Alabama at Birmingham                               *
2          *  AS project                                            *
3          **********************************************************************;
4          options pagesize=74 linesize=150 pageno=1 missing=' ' date FORMCHAR="|----|+|---+=|-/\<>*";
5          * Programmer    : Benjamin Chan <chanb@ohsu.edu>
6          * Creation date :
7          * Modify date   :
8          ;
9          %let cmt=buildExposureFollowUp; * type the name of your program here (without the filename extension);
10         %let pgm=&cmt..sas;
11         %include "lib\libname.sas" ;
NOTE: Libref STDC5P was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: H:\studies\osteo\data\STD_files\5pct\
NOTE: Libref STD_SABR was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: q:\data\std_SABER\
NOTE: Libref MPSTD was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: h:\studies\mpcd\data\stddata\
NOTE: Libref UCBSTD was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: q:\studies\AS\data\stddata\
NOTE: Libref UCB was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: q:\studies\AS\data\UCB\
NOTE: Libref DT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: V:\studies\AS\data
92         footnote "&pgm.";
93         * footnote2 "%sysfunc(datetime(),datetime14.)";
94         title1 '--- AS project ---';
95         **********************************************************************;
96         options macrogen mlogic mprint symbolgen;
97         options nomacrogen nomlogic nomprint nosymbolgen;
98         
99         
100        ods html
101          body = "output\&cmt..html"
102          style = Statistical;
NOTE: Writing HTML Body file: output\buildExposureFollowUp.html
2                                                                   The SAS System                                     16:50 Friday, September 8, 2017

103        
104        
105        /*
106        See the *Compact Outcome Definition* worksheet in `AS Project Cohort Outcome Codebook-20170410.xlsx`
107         */
108        
109        
110        /*
111        From: Xie, Fenglong [mailto:fenglongxie@uabmc.edu]
112        Sent: Wednesday, May 17, 2017 7:03 AM
113        To: Benjamin Chan <chanb@ohsu.edu>
114        Subject: RE: AS project data
115        
116        Hi, Ben
117        
118        The data are stored at UCB library defined as below email.
119        
120        Attached please find the cohort list.
121        
122        No exclusion was done except excluded for higher level exposure in six month
123        baseline.
124        
125        You need to do appropriate censor (such as censor for discontinues of
126        exposure, switch to same level or higher lever exposure ...).
127        
128        If you have question, please let me know.
129         */
130        
131        
132        proc sql;
133          create table Work.indexLookup as
134            select * from DT.indexLookup
135            order by database, patid, indexDate;
NOTE: Table WORK.INDEXLOOKUP created, with 60010 rows and 13 columns.

136        /*
137        Attach exposure end dates to exposure segments
138         */
139          create table Work.temp0 as
140            select A.database,
141                   A.patid,
142                   A.enr_end_date,
143                   A.death_date,
144                   A.exposure as exposureA,
145                   A.indexDate format = mmddyy10. as indexStartA,
146                   min(B.indexDate - 1, A.enr_end_date, A.death_date) format = mmddyy10. as indexEndA,
147                   B.exposure as exposureB,
148                   B.indexDate format = mmddyy10. as indexStartB
149            from Work.indexLookup A left join
150                 Work.indexLookup B on (A.database = B.database &
151                                        A.patid = B.patid &
152                                        A.indexDate < B.indexDate);
NOTE: Table WORK.TEMP0 created, with 71797 rows and 9 columns.

153          create table Work.tempLookup as
154            select database,
155                   patid,
156                   indexStartA,
157                   min(indexEndA) as earliestIndexEndA
158            from Work.temp0
159            group by database,
160                     patid,
161                     indexStartA;
NOTE: Table WORK.TEMPLOOKUP created, with 59836 rows and 4 columns.

162          create table Work.tempExposureSegments as
163            select A.database,
164                   A.patid,
165                   A.enr_end_date,
166                   A.death_date,
167                   A.exposureA as exposure,
168                   A.indexStartA as exposureStart,
3                                                                   The SAS System                                     16:50 Friday, September 8, 2017

169                   A.indexEndA as exposureEnd
170            from Work.temp0 A inner join
171                 Work.tempLookup B on (A.database = B.database &
172                                       A.patid = B.patid &
173                                       A.indexStartA = B.indexStartA &
174                                       A.indexEndA = B.earliestIndexEndA)
175            order by A.database,
176                     A.patid,
177                     A.indexStartA;
NOTE: Table WORK.TEMPEXPOSURESEGMENTS created, with 60252 rows and 7 columns.

178        quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.39 seconds
      cpu time            0.46 seconds
      

179        
180        
181        /*
182        Collapse exposure segments
183        
184        See *Starts and Stops: Processing Episode Data With Beginning and Ending Dates*
185        http://www2.sas.com/proceedings/sugi29/260-29.pdf
186         */
187        data DT.exposureTimeline;
188          set Work.tempExposureSegments;
189          by database patid exposure notsorted;
190          format holdPeriodStart mmddyy10.;
191          drop holdPeriodStart;
192          retain holdPeriodStart;
193          if first.exposure then do;  /* Check the last variable in the BY group */
194            holdPeriodStart = exposureStart;
195          end;
196          if last.exposure then do;  /* Check the last variable in the BY group */
197            exposureStart = holdPeriodStart;
198            output;
199          end;
200        run;

NOTE: There were 60252 observations read from the data set WORK.TEMPEXPOSURESEGMENTS.
NOTE: The data set DT.EXPOSURETIMELINE has 46055 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.06 seconds
      cpu time            0.04 seconds
      

201        proc sql;
202          alter table DT.exposureTimeline add daysExposed numeric;
NOTE: Table DT.EXPOSURETIMELINE has been modified, with 8 columns.
203          update DT.exposureTimeline
204            set daysExposed = exposureEnd - exposureStart + 1;
NOTE: 46055 rows were updated in DT.EXPOSURETIMELINE.

205          alter table DT.exposureTimeline add exposureID numeric;
NOTE: Table DT.EXPOSURETIMELINE has been modified, with 9 columns.
206          update DT.exposureTimeline
207            set exposureID = monotonic();
NOTE: 46055 rows were updated in DT.EXPOSURETIMELINE.

208        quit ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.24 seconds
      cpu time            0.18 seconds
      

209        
210        
211        proc means data = DT.exposureTimeline n sum mean std min q1 median q3 max maxdec = 1;
212          class database exposure;
213          var daysExposed;
214        run;
4                                                                   The SAS System                                     16:50 Friday, September 8, 2017


                                                                  --- AS project ---                               16:50 Friday, September 8, 2017   1

                                                                 The MEANS Procedure

                                                           Analysis Variable : daysExposed 
 
                                                                                                                  Lower                       Upper
   database    exposure              N Obs      N           Sum          Mean       Std Dev       Minimum      Quartile        Median      Quartile
   ------------------------------------------------------------------------------------------------------------------------------------------------
   MPCD        DMARD                   423    423      156022.0         368.8         319.8           1.0         102.0         295.0         551.0

               NSAID or no exposure   2093   2093      969119.0         463.0         385.5           1.0         127.0         375.0         726.0

               TNF                    1108   1108      549883.0         496.3         341.4           1.0         221.0         434.0         742.5

   Marketscan  DMARD                  1813   1813      657448.0         362.6         355.2           1.0          88.0         238.0         527.0

               NSAID or no exposure   8122   8122     3382321.0         416.4         423.8           1.0          85.0         251.0         625.0

               TNF                    4824   4824     2458598.0         509.7         407.4           1.0         169.0         412.0         762.0

   Medicare    DMARD                  4304   4304     3311124.0         769.3         704.8           1.0         207.0         534.0        1146.5

               NSAID or no exposure  18431  18431    14359942.0         779.1         776.9           1.0         182.0         547.0        1127.0

               TNF                    4937   4937     4973067.0        1007.3         785.8           1.0         351.0         805.0        1519.0
   ------------------------------------------------------------------------------------------------------------------------------------------------

                                                          Analysis Variable : daysExposed 
 
                                                database    exposure              N Obs       Maximum
                                                -----------------------------------------------------
                                                MPCD        DMARD                   423        1227.0

                                                            NSAID or no exposure   2093        1278.0

                                                            TNF                    1108        1276.0

                                                Marketscan  DMARD                  1813        1625.0

                                                            NSAID or no exposure   8122        1643.0

                                                            TNF                    4824        1637.0

                                                Medicare    DMARD                  4304        3101.0

                                                            NSAID or no exposure  18431        3104.0

                                                            TNF                    4937        3095.0
                                                -----------------------------------------------------
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
                                                              buildExposureFollowUp.sas
NOTE: There were 46055 observations read from the data set DT.EXPOSURETIMELINE.
NOTE: The PROCEDURE MEANS printed page 1.
NOTE: PROCEDURE MEANS used (Total process time):
      real time           0.15 seconds
      cpu time            0.07 seconds
      

215        
216        
217        ods html close;
NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           1.32 seconds
      cpu time            1.15 seconds
      
