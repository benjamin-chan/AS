1                                                          The SAS System                         11:33 Thursday, September 28, 2017

NOTE: Copyright (c) 2002-2012 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.4 (TS1M1) 
      Licensed to UNIVERSITY OF ALABAMA AT BIRMINGHAM - SFA - T&R, Site 70058223.
NOTE: This session is executing on the W32_ES08R2  platform.



NOTE: Updated analytical products:
      
      SAS/STAT 13.1
      SAS/ETS 13.1
      SAS/OR 13.1
      SAS/IML 13.1
      SAS/QC 13.1

NOTE: Additional host information:

 W32_ES08R2 WIN 6.1.7601 Service Pack 1 Server

--- PEER News and Updates ---

: SECURITY REMINDER :
Please remember not to copy any data files that contain PHI (protected health identifiers) to any of the shared folders.

 


NOTE: SAS initialization used:
      real time           0.12 seconds
      cpu time            0.10 seconds
      
1          *  University of Alabama at Birmingham                               *
2          *  AS project                                            *
3          **********************************************************************;
4          options pagesize=74 linesize=150 pageno=1 missing=' ' date FORMCHAR="|----|+|---+=|-/\<>*";
5          * Programmer    : Benjamin Chan <chanb@ohsu.edu>
6          * Creation date :
7          * Modify date   :
8          ;
9          %let cmt=buildServiceCodeDatasets; * type the name of your program here (without the filename extension);
10         %let pgm=&cmt..sas;
11         %include "lib\libname.sas" ;
NOTE: Libref STDC5P was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: H:\studies\osteo\data\STD_files\5pct\
NOTE: Libref STD_SABR was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: q:\data\std_SABER\
NOTE: Libref MPSTD was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: h:\studies\mpcd\data\stddata\
NOTE: Libref UCBSTD was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: q:\studies\AS\data\stddata\
NOTE: Libref UCB was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: q:\studies\AS\data\UCB\
NOTE: Libref DT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: V:\studies\AS\data
92         footnote "&pgm.";
93         * footnote2 "%sysfunc(datetime(),datetime14.)";
94         title1 '--- AS project ---';
95         **********************************************************************;
96         options macrogen mlogic mprint symbolgen;
97         options nomacrogen nomlogic nomprint nosymbolgen;
98         
99         
100        ods html
101          body = "output\&cmt..html"
102          style = Statistical;
NOTE: Writing HTML Body file: output\buildServiceCodeDatasets.html
2                                                                   The SAS System                                  11:33 Thursday, September 28, 2017

103        
104        
105        /*
106        From: Chen, Lang [mailto:langchen@uabmc.edu]
107        Sent: Monday, September 11, 2017 1:59 PM
108        To: Benjamin Chan <chanb@ohsu.edu>; Curtis, Jeffrey R <jrcurtis@uabmc.edu>; Kevin Winthrop <winthrop@ohsu.edu>
109        Cc: Atul Deodhar <deodhara@ohsu.edu>; Sarah Siegel <siegels@ohsu.edu>; Yang, Shuo <shuoyang@uabmc.edu>; Xie, Fenglong
109      ! <fenglongxie@uabmc.edu>
110        Subject: RE: quick summary of AS call
111        
112        physician-diagnosed codes is usually define by IP AV ED NH and HH. We usually
113        do not use provider type field. Provider type is provider specialty and MPCD
114        and CMS use different coding system.
115         */
116        
117        
118        /*
119        Service code data sets for prevalence (non-fracture outcomes)
120         */
121        %let type = Prev;
122        %let select1 = select A.*, B.enc_type, B.admit_date, B.begin_date, B.discharge_date, B.end_date, B.dx_type, B.dx, B.pdx, "ICD9-DX" as
122      ! codeType, B.dx as code;
123        %let on1 = on (A.patid = B.patid);
124        %let select2 = select A.patid, A.enc_type, A.admit_date, A.begin_date, A.discharge_date, A.end_date, A.dx_type, A.dx, A.pdx;
125        %let where2 = where A.dx_type = "09" & A.enc_type in ("IP", "AV", "ED", "NH", "HH");
126        %let selectfrom3 = select * from DT.indexLookup;
127        
128        %include "lib\buildDx.sas";  /* Call script to query ICD-9 diagnosis codes */
NOTE: Table UCB.TEMPLOOKUPMPCD created, with 4353 rows and 13 columns.

NOTE: Table UCB.TEMP0710 created, with 176326981 rows and 9 columns.

NOTE: Table UCB.TEMPPREVDXMPCD created, with 446656 rows and 23 columns.

NOTE: Table UCB.TEMP0710 has been dropped.
NOTE: Table UCB.TEMPLOOKUPMARKETSCAN created, with 18413 rows and 13 columns.

NOTE: Parallel WHERE evaluation suppressed due to sort order on table.
NOTE: Table UCB.TEMP10 created, with 137626649 rows and 9 columns.

NOTE: Parallel WHERE evaluation suppressed due to sort order on table.
NOTE: Table UCB.TEMP11 created, with 178130212 rows and 9 columns.

NOTE: Parallel WHERE evaluation suppressed due to sort order on table.
NOTE: Table UCB.TEMP12 created, with 214880646 rows and 9 columns.

NOTE: Parallel WHERE evaluation suppressed due to sort order on table.
NOTE: Table UCB.TEMP13 created, with 205056808 rows and 9 columns.

NOTE: Parallel WHERE evaluation suppressed due to sort order on table.
NOTE: Table UCB.TEMP14 created, with 227966392 rows and 9 columns.

NOTE: Table UCB.TEMPPREVDXUCB created, with 1617715 rows and 23 columns.

NOTE: Table UCB.TEMP10 has been dropped.
NOTE: Table UCB.TEMP11 has been dropped.
NOTE: Table UCB.TEMP12 has been dropped.
NOTE: Table UCB.TEMP13 has been dropped.
NOTE: Table UCB.TEMP14 has been dropped.
NOTE: Table UCB.TEMPLOOKUPMEDICARE created, with 37244 rows and 13 columns.

NOTE: Table UCB.TEMP06 created, with 87381052 rows and 9 columns.

NOTE: Table UCB.TEMP07 created, with 94990718 rows and 9 columns.

NOTE: Table UCB.TEMP08 created, with 99936827 rows and 9 columns.

NOTE: Table UCB.TEMP09 created, with 102632529 rows and 9 columns.

NOTE: Table UCB.TEMP10 created, with 124547135 rows and 9 columns.

NOTE: Table UCB.TEMP11 created, with 172183986 rows and 9 columns.
3                                                                   The SAS System                                  11:33 Thursday, September 28, 2017


NOTE: Table UCB.TEMP12 created, with 152144211 rows and 9 columns.

NOTE: Table UCB.TEMP13 created, with 315380297 rows and 9 columns.

NOTE: Table UCB.TEMP14 created, with 360484305 rows and 9 columns.

NOTE: Table UCB.TEMPPREVDXSABR created, with 15242768 rows and 23 columns.

NOTE: Table UCB.TEMP06 has been dropped.
NOTE: Table UCB.TEMP07 has been dropped.
NOTE: Table UCB.TEMP08 has been dropped.
NOTE: Table UCB.TEMP09 has been dropped.
NOTE: Table UCB.TEMP10 has been dropped.
NOTE: Table UCB.TEMP11 has been dropped.
NOTE: Table UCB.TEMP12 has been dropped.
NOTE: Table UCB.TEMP13 has been dropped.
NOTE: Table UCB.TEMP14 has been dropped.
NOTE: Table UCB.TEMPPREVDXALL created, with 17237427 rows and 23 columns.

                                                                  --- AS project ---                            11:33 Thursday, September 28, 2017   1

                                                 table              database                       n
                                                 ---------------------------------------------------
                                                 UCB.tempPrevDxAll  MPCD                     376,944
                                                 UCB.tempPrevDxAll  Marketscan             1,617,715
                                                 UCB.tempPrevDxAll  Medicare              15,242,768
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
                                                             buildServiceCodeDatasets.sas
NOTE: Table UCB.TEMPPREVDXMPCD has been dropped.
NOTE: Table UCB.TEMPPREVDXUCB has been dropped.
NOTE: Table UCB.TEMPPREVDXSABR has been dropped.
NOTE: The PROCEDURE SQL printed page 1.
NOTE: PROCEDURE SQL used (Total process time):
      real time           1:39:28.75
      cpu time            1:02:26.44
      

195        
196        %let select1 = select A.*,
197                              B.admit_date, B.begin_date, B.discharge_date, B.end_date, B.px_date, B.px_type, B.px,
198                              case
199                                when B.px_type = "09" then "ICD9-PX"
200                                when B.px_type = "C1" | ^anyalpha(strip(B.px)) then "CPT"
201                                when B.px_type = "H1" & anyalpha(substr(strip(B.px), 1, 1)) & ^anyalpha(strip(B.px), 2) then "HCPCS"
202                                else ""
203                                end as codeType,
204                              B.px as code;
205        %let select2 = select patid, admit_date, begin_date, discharge_date, end_date, px_date, px_type, px;
206        
207        %include "lib\buildPx.sas";  /* Call script to query procedure codes */
NOTE: Table UCB.TEMP0710 created, with 346484578 rows and 8 columns.

NOTE: Table UCB.TEMPPREVPXMPCD created, with 880584 rows and 22 columns.

NOTE: Table UCB.TEMP0710 has been dropped.
NOTE: Table UCB.TEMP10 created, with 391592729 rows and 8 columns.

NOTE: Table UCB.TEMP11 created, with 491685366 rows and 8 columns.

NOTE: Table UCB.TEMP12 created, with 578756109 rows and 8 columns.

NOTE: Table UCB.TEMP13 created, with 524982991 rows and 8 columns.

NOTE: Table UCB.TEMP14 created, with 562542993 rows and 8 columns.

NOTE: Table UCB.TEMPPREVPXUCB created, with 4303647 rows and 22 columns.

NOTE: Table UCB.TEMP10 has been dropped.
NOTE: Table UCB.TEMP11 has been dropped.
NOTE: Table UCB.TEMP12 has been dropped.
NOTE: Table UCB.TEMP13 has been dropped.
NOTE: Table UCB.TEMP14 has been dropped.
NOTE: Table UCB.TEMP06 created, with 168021311 rows and 8 columns.

NOTE: Table UCB.TEMP07 created, with 184413125 rows and 8 columns.

NOTE: Table UCB.TEMP08 created, with 195342614 rows and 8 columns.

NOTE: Table UCB.TEMP09 created, with 201608393 rows and 8 columns.

4                                                                   The SAS System                                  11:33 Thursday, September 28, 2017

NOTE: Table UCB.TEMP10 created, with 224496201 rows and 8 columns.

NOTE: Table UCB.TEMP11 created, with 246477259 rows and 8 columns.

NOTE: Table UCB.TEMP12 created, with 310647729 rows and 8 columns.

NOTE: Table UCB.TEMP13 created, with 447988736 rows and 8 columns.

NOTE: Table UCB.TEMP14 created, with 535737236 rows and 8 columns.

NOTE: Table UCB.TEMPPREVPXSABR created, with 29446326 rows and 22 columns.

NOTE: Table UCB.TEMP06 has been dropped.
NOTE: Table UCB.TEMP07 has been dropped.
NOTE: Table UCB.TEMP08 has been dropped.
NOTE: Table UCB.TEMP09 has been dropped.
NOTE: Table UCB.TEMP10 has been dropped.
NOTE: Table UCB.TEMP11 has been dropped.
NOTE: Table UCB.TEMP12 has been dropped.
NOTE: Table UCB.TEMP13 has been dropped.
NOTE: Table UCB.TEMP14 has been dropped.
NOTE: Table UCB.TEMPPREVPXALL created, with 34498359 rows and 22 columns.

                                                                  --- AS project ---                            11:33 Thursday, September 28, 2017   2

                                                 table              database                       n
                                                 ---------------------------------------------------
                                                 UCB.tempPrevPxAll  MPCD                     748,386
                                                 UCB.tempPrevPxAll  Marketscan             4,303,647
                                                 UCB.tempPrevPxAll  Medicare              29,446,326
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
                                                             buildServiceCodeDatasets.sas
NOTE: Table UCB.TEMPPREVPXMPCD has been dropped.
NOTE: Table UCB.TEMPPREVPXUCB has been dropped.
NOTE: Table UCB.TEMPPREVPXSABR has been dropped.
NOTE: The PROCEDURE SQL printed page 2.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3:28:53.36
      cpu time            1:59:35.46
      

271        
272        
273        /*
274        Service code data sets for incidence (non-fracture outcomes)
275         */
276        %let type = Inc;
277        %let select1 = select A.*, B.enc_type, B.admit_date, B.begin_date, B.discharge_date, B.end_date, B.dx_type, B.dx, B.pdx, "ICD9-DX" as
277      ! codeType, B.dx as code;
278        %let on1 = on (A.patid = B.patid & A.exposureStart <= B.begin_date <= A.exposureEnd);
279        %let select2 = select A.patid, A.enc_type, A.admit_date, A.begin_date, A.discharge_date, A.end_date, A.dx_type, A.dx, A.pdx;
280        %let where2 = where dx_type = "09" & A.enc_type in ("IP", "AV", "ED", "NH", "HH");
281        %let selectfrom3 = select * from DT.exposureTimeline;
282        
283        %include "lib\buildDx.sas";  /* Call script to query ICD-9 diagnosis codes */
NOTE: Table UCB.TEMPLOOKUPMPCD created, with 4353 rows and 11 columns.

NOTE: Table UCB.TEMP0710 created, with 176326981 rows and 9 columns.

NOTE: Table UCB.TEMPINCDXMPCD created, with 162880 rows and 21 columns.

NOTE: Table UCB.TEMP0710 has been dropped.
NOTE: Table UCB.TEMPLOOKUPMARKETSCAN created, with 18413 rows and 11 columns.

NOTE: Parallel WHERE evaluation suppressed due to sort order on table.
NOTE: Table UCB.TEMP10 created, with 137626649 rows and 9 columns.

NOTE: Parallel WHERE evaluation suppressed due to sort order on table.
NOTE: Table UCB.TEMP11 created, with 178130212 rows and 9 columns.

NOTE: Parallel WHERE evaluation suppressed due to sort order on table.
NOTE: Table UCB.TEMP12 created, with 214880646 rows and 9 columns.

NOTE: Parallel WHERE evaluation suppressed due to sort order on table.
NOTE: Table UCB.TEMP13 created, with 205056808 rows and 9 columns.

NOTE: Parallel WHERE evaluation suppressed due to sort order on table.
NOTE: Table UCB.TEMP14 created, with 227966392 rows and 9 columns.

NOTE: Table UCB.TEMPINCDXUCB created, with 490541 rows and 21 columns.

5                                                                   The SAS System                                  11:33 Thursday, September 28, 2017

NOTE: Table UCB.TEMP10 has been dropped.
NOTE: Table UCB.TEMP11 has been dropped.
NOTE: Table UCB.TEMP12 has been dropped.
NOTE: Table UCB.TEMP13 has been dropped.
NOTE: Table UCB.TEMP14 has been dropped.
NOTE: Table UCB.TEMPLOOKUPMEDICARE created, with 37244 rows and 11 columns.

NOTE: Table UCB.TEMP06 created, with 87381052 rows and 9 columns.

NOTE: Table UCB.TEMP07 created, with 94990718 rows and 9 columns.

NOTE: Table UCB.TEMP08 created, with 99936827 rows and 9 columns.

NOTE: Table UCB.TEMP09 created, with 102632529 rows and 9 columns.

NOTE: Table UCB.TEMP10 created, with 124547135 rows and 9 columns.

NOTE: Table UCB.TEMP11 created, with 172183986 rows and 9 columns.

NOTE: Table UCB.TEMP12 created, with 152144211 rows and 9 columns.

NOTE: Table UCB.TEMP13 created, with 315380297 rows and 9 columns.

NOTE: Table UCB.TEMP14 created, with 360484305 rows and 9 columns.

NOTE: Table UCB.TEMPINCDXSABR created, with 4506280 rows and 21 columns.

NOTE: Table UCB.TEMP06 has been dropped.
NOTE: Table UCB.TEMP07 has been dropped.
NOTE: Table UCB.TEMP08 has been dropped.
NOTE: Table UCB.TEMP09 has been dropped.
NOTE: Table UCB.TEMP10 has been dropped.
NOTE: Table UCB.TEMP11 has been dropped.
NOTE: Table UCB.TEMP12 has been dropped.
NOTE: Table UCB.TEMP13 has been dropped.
NOTE: Table UCB.TEMP14 has been dropped.
NOTE: Table UCB.TEMPINCDXALL created, with 5129437 rows and 21 columns.

                                                                  --- AS project ---                            11:33 Thursday, September 28, 2017   3

                                                  table             database                       n
                                                  --------------------------------------------------
                                                  UCB.tempIncDxAll  MPCD                     132,616
                                                  UCB.tempIncDxAll  Marketscan               490,541
                                                  UCB.tempIncDxAll  Medicare               4,506,280
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
                                                             buildServiceCodeDatasets.sas
NOTE: Table UCB.TEMPINCDXMPCD has been dropped.
NOTE: Table UCB.TEMPINCDXUCB has been dropped.
NOTE: Table UCB.TEMPINCDXSABR has been dropped.
NOTE: The PROCEDURE SQL printed page 3.
NOTE: PROCEDURE SQL used (Total process time):
      real time           1:39:34.01
      cpu time            1:02:28.89
      

350        
351        %let select1 = select A.*,
352                              B.admit_date, B.begin_date, B.discharge_date, B.end_date, B.px_date, B.px_type, B.px,
353                              case
354                                when B.px_type = "09" then "ICD9-PX"
355                                when B.px_type = "C1" | ^anyalpha(strip(B.px)) then "CPT"
356                                when B.px_type = "H1" & anyalpha(substr(strip(B.px), 1, 1)) & ^anyalpha(strip(B.px), 2) then "HCPCS"
357                                else ""
358                                end as codeType,
359                              B.px as code;
360        %let select2 = select patid, admit_date, begin_date, discharge_date, end_date, px_date, px_type, px;
361        
362        %include "lib\buildPx.sas";  /* Call script to query procedure codes */
NOTE: Table UCB.TEMP0710 created, with 346484578 rows and 8 columns.

NOTE: Table UCB.TEMPINCPXMPCD created, with 289945 rows and 20 columns.

NOTE: Table UCB.TEMP0710 has been dropped.
NOTE: Table UCB.TEMP10 created, with 391592729 rows and 8 columns.

NOTE: Table UCB.TEMP11 created, with 491685366 rows and 8 columns.

NOTE: Table UCB.TEMP12 created, with 578756109 rows and 8 columns.

NOTE: Table UCB.TEMP13 created, with 524982991 rows and 8 columns.
6                                                                   The SAS System                                  11:33 Thursday, September 28, 2017


NOTE: Table UCB.TEMP14 created, with 562542993 rows and 8 columns.

NOTE: Table UCB.TEMPINCPXUCB created, with 1233353 rows and 20 columns.

NOTE: Table UCB.TEMP10 has been dropped.
NOTE: Table UCB.TEMP11 has been dropped.
NOTE: Table UCB.TEMP12 has been dropped.
NOTE: Table UCB.TEMP13 has been dropped.
NOTE: Table UCB.TEMP14 has been dropped.
NOTE: Table UCB.TEMP06 created, with 168021311 rows and 8 columns.

NOTE: Table UCB.TEMP07 created, with 184413125 rows and 8 columns.

NOTE: Table UCB.TEMP08 created, with 195342614 rows and 8 columns.

NOTE: Table UCB.TEMP09 created, with 201608393 rows and 8 columns.

NOTE: Table UCB.TEMP10 created, with 224496201 rows and 8 columns.

NOTE: Table UCB.TEMP11 created, with 246477259 rows and 8 columns.

NOTE: Table UCB.TEMP12 created, with 310647729 rows and 8 columns.

NOTE: Table UCB.TEMP13 created, with 447988736 rows and 8 columns.

NOTE: Table UCB.TEMP14 created, with 535737236 rows and 8 columns.

NOTE: Table UCB.TEMPINCPXSABR created, with 6349254 rows and 20 columns.

NOTE: Table UCB.TEMP06 has been dropped.
NOTE: Table UCB.TEMP07 has been dropped.
NOTE: Table UCB.TEMP08 has been dropped.
NOTE: Table UCB.TEMP09 has been dropped.
NOTE: Table UCB.TEMP10 has been dropped.
NOTE: Table UCB.TEMP11 has been dropped.
NOTE: Table UCB.TEMP12 has been dropped.
NOTE: Table UCB.TEMP13 has been dropped.
NOTE: Table UCB.TEMP14 has been dropped.
NOTE: Table UCB.TEMPINCPXALL created, with 7830153 rows and 20 columns.

                                                                  --- AS project ---                            11:33 Thursday, September 28, 2017   4

                                                  table             database                       n
                                                  --------------------------------------------------
                                                  UCB.tempIncPxAll  MPCD                     247,546
                                                  UCB.tempIncPxAll  Marketscan             1,233,353
                                                  UCB.tempIncPxAll  Medicare               6,349,254
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
                                                             buildServiceCodeDatasets.sas
NOTE: Table UCB.TEMPINCPXMPCD has been dropped.
NOTE: Table UCB.TEMPINCPXUCB has been dropped.
NOTE: Table UCB.TEMPINCPXSABR has been dropped.
NOTE: The PROCEDURE SQL printed page 4.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3:18:11.51
      cpu time            1:49:53.92
      

426        
427        %let select1 = select A.*,
428                              B.dispense_date, B.ndc, B.gnn, B.dispense_sup;
429        %let on1 = on (A.patid = B.patid & A.exposureStart <= B.dispense_date <= A.exposureEnd);
430        %let select2 = select patid, dispense_date, ndc, gnn, dispense_sup;
431        
432        %include "lib\buildRx.sas";  /* Call script to query prescription drug codes */
NOTE: Table UCB.TEMPLOOKUPMPCD created, with 4353 rows and 11 columns.

NOTE: Table UCB.TEMP0710 created, with 153423631 rows and 5 columns.

NOTE: Table UCB.TEMPINCRXMPCD created, with 124981 rows and 15 columns.

NOTE: Table UCB.TEMP0710 has been dropped.
NOTE: Table UCB.TEMPLOOKUPMARKETSCAN created, with 18413 rows and 11 columns.

NOTE: Table UCB.TEMP10 created, with 147476609 rows and 5 columns.

NOTE: Table UCB.TEMP11 created, with 179818303 rows and 5 columns.

NOTE: Table UCB.TEMP12 created, with 204668116 rows and 5 columns.

7                                                                   The SAS System                                  11:33 Thursday, September 28, 2017

NOTE: Table UCB.TEMP13 created, with 186286652 rows and 5 columns.

NOTE: Table UCB.TEMP14 created, with 187111269 rows and 5 columns.

NOTE: Table UCB.TEMPINCRXUCB created, with 608066 rows and 15 columns.

NOTE: Table UCB.TEMP10 has been dropped.
NOTE: Table UCB.TEMP11 has been dropped.
NOTE: Table UCB.TEMP12 has been dropped.
NOTE: Table UCB.TEMP13 has been dropped.
NOTE: Table UCB.TEMP14 has been dropped.
NOTE: Table UCB.TEMPLOOKUPMEDICARE created, with 37244 rows and 11 columns.

NOTE: Table UCB.TEMP06 created, with 39942372 rows and 5 columns.

NOTE: Table UCB.TEMP07 created, with 49750603 rows and 5 columns.

NOTE: Table UCB.TEMP08 created, with 53490593 rows and 5 columns.

NOTE: Table UCB.TEMP09 created, with 54726319 rows and 5 columns.

NOTE: Table UCB.TEMP10 created, with 62361393 rows and 5 columns.

NOTE: Table UCB.TEMP11 created, with 70577350 rows and 5 columns.

NOTE: Table UCB.TEMP12 created, with 88278950 rows and 5 columns.

NOTE: Table UCB.TEMP13 created, with 138804400 rows and 5 columns.

NOTE: Table UCB.TEMP14 created, with 169727579 rows and 5 columns.

NOTE: Table UCB.TEMPINCRXSABR created, with 3541242 rows and 15 columns.

NOTE: Table UCB.TEMP06 has been dropped.
NOTE: Table UCB.TEMP07 has been dropped.
NOTE: Table UCB.TEMP08 has been dropped.
NOTE: Table UCB.TEMP09 has been dropped.
NOTE: Table UCB.TEMP10 has been dropped.
NOTE: Table UCB.TEMP11 has been dropped.
NOTE: Table UCB.TEMP12 has been dropped.
NOTE: Table UCB.TEMP13 has been dropped.
NOTE: Table UCB.TEMP14 has been dropped.
NOTE: Table UCB.TEMPINCRXALL created, with 4273219 rows and 15 columns.

                                                                  --- AS project ---                            11:33 Thursday, September 28, 2017   5

                                                  table             database                       n
                                                  --------------------------------------------------
                                                  UCB.tempIncRxAll  MPCD                     123,911
                                                  UCB.tempIncRxAll  Marketscan               608,066
                                                  UCB.tempIncRxAll  Medicare               3,541,242
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
                                                             buildServiceCodeDatasets.sas
NOTE: Table UCB.TEMPINCRXMPCD has been dropped.
NOTE: Table UCB.TEMPINCRXUCB has been dropped.
NOTE: Table UCB.TEMPINCRXSABR has been dropped.
NOTE: The PROCEDURE SQL printed page 5.
NOTE: PROCEDURE SQL used (Total process time):
      real time           1:23:28.66
      cpu time            34:41.20
      

499        
500        
501        /*
502        Service code data sets for fracture outcomes
503        Fracture service code data sets are used for both prevalence and incidence;
504        unlike non-fracture service code data sets
505         */
506        %let type = Frac;
507        %let select1 = select A.*,
508                              B.encounterID, B.enc_type, B.admit_date, B.begin_date, B.discharge_date, B.end_date, B.dx_type, B.dx, B.pdx,
508      ! "ICD9-DX" as codeType, B.dx as code,
509                              B.diagCodeType;
510        %let on1 = on (A.patid = B.patid);
511        %let select2 = select A.patid, A.encounterID, A.enc_type, A.admit_date, A.begin_date, A.discharge_date, A.end_date, A.dx_type, A.dx, A.pdx,
512                              case
513                                when '800' <= substr(A.dx, 1, 3) <= '829' or substr(A.dx, 1, 4) = '7331' then "Fracture code"
514                                when substr(A.dx, 1, 4) in ('V541' 'V542') then "Extended care code"
515                                when 'E800' <= substr(A.dx, 1, 4) <= 'E848' or
516                                     'E881' <= substr(A.dx, 1, 4) <= 'E884' or
8                                                                   The SAS System                                  11:33 Thursday, September 28, 2017

517                                     'E908' <= substr(A.dx, 1, 4) <= 'E909' or
518                                     'E916' <= substr(A.dx, 1, 4) <= 'E928'
519                                  then "Trauma code"
520                                else ""
521                                end as diagCodeType;
522        %let where2 = where A.dx_type = "09" & A.enc_type in ("IP", "AV", "ED", "NH", "HH") & ^missing(calculated diagCodeType);
523        %let selectfrom3 = select * from DT.indexLookup;
524        
525        %include "lib\buildDx.sas";  /* Call script to query ICD-9 diagnosis codes */
NOTE: Table UCB.TEMPLOOKUPMPCD created, with 4353 rows and 13 columns.

NOTE: Table UCB.TEMP0710 created, with 1649572 rows and 11 columns.

NOTE: Table UCB.TEMPFRACDXMPCD created, with 3831 rows and 25 columns.

NOTE: Table UCB.TEMP0710 has been dropped.
NOTE: Table UCB.TEMPLOOKUPMARKETSCAN created, with 18413 rows and 13 columns.

NOTE: Parallel WHERE evaluation suppressed due to sort order on table.
NOTE: Table UCB.TEMP10 created, with 1265389 rows and 11 columns.

NOTE: Parallel WHERE evaluation suppressed due to sort order on table.
NOTE: Table UCB.TEMP11 created, with 1570425 rows and 11 columns.

NOTE: Parallel WHERE evaluation suppressed due to sort order on table.
NOTE: Table UCB.TEMP12 created, with 1809683 rows and 11 columns.

NOTE: Parallel WHERE evaluation suppressed due to sort order on table.
NOTE: Table UCB.TEMP13 created, with 1663844 rows and 11 columns.

NOTE: Parallel WHERE evaluation suppressed due to sort order on table.
NOTE: Table UCB.TEMP14 created, with 1824609 rows and 11 columns.

NOTE: Table UCB.TEMPFRACDXUCB created, with 10475 rows and 25 columns.

NOTE: Table UCB.TEMP10 has been dropped.
NOTE: Table UCB.TEMP11 has been dropped.
NOTE: Table UCB.TEMP12 has been dropped.
NOTE: Table UCB.TEMP13 has been dropped.
NOTE: Table UCB.TEMP14 has been dropped.
NOTE: Table UCB.TEMPLOOKUPMEDICARE created, with 37244 rows and 13 columns.

NOTE: Table UCB.TEMP06 created, with 656299 rows and 11 columns.

NOTE: Table UCB.TEMP07 created, with 736455 rows and 11 columns.

NOTE: Table UCB.TEMP08 created, with 777750 rows and 11 columns.

NOTE: Table UCB.TEMP09 created, with 839584 rows and 11 columns.

NOTE: Table UCB.TEMP10 created, with 1143221 rows and 11 columns.

NOTE: Table UCB.TEMP11 created, with 1556455 rows and 11 columns.

NOTE: Table UCB.TEMP12 created, with 1482270 rows and 11 columns.

NOTE: Table UCB.TEMP13 created, with 2819329 rows and 11 columns.

NOTE: Table UCB.TEMP14 created, with 3343029 rows and 11 columns.

NOTE: Table UCB.TEMPFRACDXSABR created, with 141154 rows and 25 columns.

NOTE: Table UCB.TEMP06 has been dropped.
NOTE: Table UCB.TEMP07 has been dropped.
NOTE: Table UCB.TEMP08 has been dropped.
NOTE: Table UCB.TEMP09 has been dropped.
NOTE: Table UCB.TEMP10 has been dropped.
NOTE: Table UCB.TEMP11 has been dropped.
NOTE: Table UCB.TEMP12 has been dropped.
NOTE: Table UCB.TEMP13 has been dropped.
NOTE: Table UCB.TEMP14 has been dropped.
NOTE: Table UCB.TEMPFRACDXALL created, with 154932 rows and 25 columns.
9                                                                   The SAS System                                  11:33 Thursday, September 28, 2017


                                                                  --- AS project ---                            11:33 Thursday, September 28, 2017   6

                                                 table              database                       n
                                                 ---------------------------------------------------
                                                 UCB.tempFracDxAll  MPCD                       3,303
                                                 UCB.tempFracDxAll  Marketscan                10,475
                                                 UCB.tempFracDxAll  Medicare                 141,154
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
                                                             buildServiceCodeDatasets.sas
NOTE: Table UCB.TEMPFRACDXMPCD has been dropped.
NOTE: Table UCB.TEMPFRACDXUCB has been dropped.
NOTE: Table UCB.TEMPFRACDXSABR has been dropped.
NOTE: The PROCEDURE SQL printed page 6.
NOTE: PROCEDURE SQL used (Total process time):
      real time           59:56.08
      cpu time            1:21:24.25
      

592        
593        %let select1 = select A.*,
594                              B.encounterID, B.admit_date, B.begin_date, B.discharge_date, B.end_date, B.px_date, B.px_type, B.px,
595                              case
596                                when B.px_type = "09" then "ICD9-PX"
597                                when B.px_type = "C1" | ^anyalpha(strip(B.px)) then "CPT"
598                                when B.px_type = "H1" & anyalpha(substr(strip(B.px), 1, 1)) & ^anyalpha(strip(B.px), 2) then "HCPCS"
599                                else ""
600                                end as codeType,
601                              B.px as code;
602        %let select2 = select patid, encounterID, admit_date, begin_date, discharge_date, end_date, px_date, px_type, px;
603        
604        %include "lib\buildPx.sas";  /* Call script to query procedure codes */
NOTE: Table UCB.TEMP0710 created, with 346484578 rows and 9 columns.

NOTE: Table UCB.TEMPFRACPXMPCD created, with 880584 rows and 23 columns.

NOTE: Table UCB.TEMP0710 has been dropped.
NOTE: Table UCB.TEMP10 created, with 391592729 rows and 9 columns.

NOTE: Table UCB.TEMP11 created, with 491685366 rows and 9 columns.

NOTE: Table UCB.TEMP12 created, with 578756109 rows and 9 columns.

NOTE: Table UCB.TEMP13 created, with 524982991 rows and 9 columns.

NOTE: Table UCB.TEMP14 created, with 562542993 rows and 9 columns.

NOTE: Table UCB.TEMPFRACPXUCB created, with 4303767 rows and 23 columns.

NOTE: Table UCB.TEMP10 has been dropped.
NOTE: Table UCB.TEMP11 has been dropped.
NOTE: Table UCB.TEMP12 has been dropped.
NOTE: Table UCB.TEMP13 has been dropped.
NOTE: Table UCB.TEMP14 has been dropped.
NOTE: Table UCB.TEMP06 created, with 168021311 rows and 9 columns.

NOTE: Table UCB.TEMP07 created, with 184413125 rows and 9 columns.

NOTE: Table UCB.TEMP08 created, with 195342614 rows and 9 columns.

NOTE: Table UCB.TEMP09 created, with 201608393 rows and 9 columns.

NOTE: Table UCB.TEMP10 created, with 224496201 rows and 9 columns.

NOTE: Table UCB.TEMP11 created, with 246477259 rows and 9 columns.

NOTE: Table UCB.TEMP12 created, with 310647729 rows and 9 columns.

NOTE: Table UCB.TEMP13 created, with 447988736 rows and 9 columns.

NOTE: Table UCB.TEMP14 created, with 535737236 rows and 9 columns.

NOTE: Table UCB.TEMPFRACPXSABR created, with 30790932 rows and 23 columns.

NOTE: Table UCB.TEMP06 has been dropped.
NOTE: Table UCB.TEMP07 has been dropped.
NOTE: Table UCB.TEMP08 has been dropped.
NOTE: Table UCB.TEMP09 has been dropped.
NOTE: Table UCB.TEMP10 has been dropped.
NOTE: Table UCB.TEMP11 has been dropped.
NOTE: Table UCB.TEMP12 has been dropped.
10                                                                  The SAS System                                  11:33 Thursday, September 28, 2017

NOTE: Table UCB.TEMP13 has been dropped.
NOTE: Table UCB.TEMP14 has been dropped.
NOTE: Table UCB.TEMPFRACPXALL created, with 35975283 rows and 23 columns.

                                                                  --- AS project ---                            11:33 Thursday, September 28, 2017   7

                                                 table              database                       n
                                                 ---------------------------------------------------
                                                 UCB.tempFracPxAll  MPCD                     880,584
                                                 UCB.tempFracPxAll  Marketscan             4,303,767
                                                 UCB.tempFracPxAll  Medicare              30,790,932
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
                                                             buildServiceCodeDatasets.sas
NOTE: Table UCB.TEMPFRACPXMPCD has been dropped.
NOTE: Table UCB.TEMPFRACPXUCB has been dropped.
NOTE: Table UCB.TEMPFRACPXSABR has been dropped.
NOTE: The PROCEDURE SQL printed page 7.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3:46:14.02
      cpu time            2:01:18.35
      

668        
669        
670        
671        
672        ods html close;
NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           16:15:46.97
      cpu time            9:51:48.90
      
