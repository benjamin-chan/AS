1                                                          The SAS System                          06:48 Tuesday, September 12, 2017

NOTE: Copyright (c) 2002-2012 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.4 (TS1M1) 
      Licensed to UNIVERSITY OF ALABAMA AT BIRMINGHAM - SFA - T&R, Site 70058223.
NOTE: This session is executing on the W32_ES08R2  platform.



NOTE: Updated analytical products:
      
      SAS/STAT 13.1
      SAS/ETS 13.1
      SAS/OR 13.1
      SAS/IML 13.1
      SAS/QC 13.1

NOTE: Additional host information:

 W32_ES08R2 WIN 6.1.7601 Service Pack 1 Server

--- PEER News and Updates ---

: SECURITY REMINDER :
Please remember not to copy any data files that contain PHI (protected health identifiers) to any of the shared folders.

 


NOTE: SAS initialization used:
      real time           0.92 seconds
      cpu time            0.10 seconds
      
1          *  University of Alabama at Birmingham                               *
2          *  AS project                                            *
3          **********************************************************************;
4          options pagesize=74 linesize=150 pageno=1 missing=' ' date FORMCHAR="|----|+|---+=|-/\<>*";
5          * Programmer    : Benjamin Chan <chanb@ohsu.edu>
6          * Creation date :
7          * Modify date   :
8          ;
9          %let cmt=buildServiceCodeDatasetsControl; * type the name of your program here (without the filename extension);
10         %let pgm=&cmt..sas;
11         %include "lib\libname.sas" ;
NOTE: Libref STDC5P was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: H:\studies\osteo\data\STD_files\5pct\
NOTE: Libref STD_SABR was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: q:\data\std_SABER\
NOTE: Libref MPSTD was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: h:\studies\mpcd\data\stddata\
NOTE: Libref UCBSTD was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: q:\studies\AS\data\stddata\
NOTE: Libref UCB was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: q:\studies\AS\data\UCB\
NOTE: Libref DT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: V:\studies\AS\data
92         footnote "&pgm.";
93         * footnote2 "%sysfunc(datetime(),datetime14.)";
94         title1 '--- AS project ---';
95         **********************************************************************;
96         options macrogen mlogic mprint symbolgen;
97         options nomacrogen nomlogic nomprint nosymbolgen;
98         
99         
100        ods html
101          body = "output\&cmt..html"
102          style = Statistical;
NOTE: Writing HTML Body file: output\buildServiceCodeDatasetsControl.html
2                                                                   The SAS System                                   06:48 Tuesday, September 12, 2017

103        
104        
105        /*
106        From: Chen, Lang [mailto:langchen@uabmc.edu]
107        Sent: Monday, September 11, 2017 1:59 PM
108        To: Benjamin Chan <chanb@ohsu.edu>; Curtis, Jeffrey R <jrcurtis@uabmc.edu>; Kevin Winthrop <winthrop@ohsu.edu>
109        Cc: Atul Deodhar <deodhara@ohsu.edu>; Sarah Siegel <siegels@ohsu.edu>; Yang, Shuo <shuoyang@uabmc.edu>; Xie, Fenglong
109      ! <fenglongxie@uabmc.edu>
110        Subject: RE: quick summary of AS call
111        
112        physician-diagnosed codes is usually define by IP AV ED NH and HH. We usually
113        do not use provider type field. Provider type is provider specialty and MPCD
114        and CMS use different coding system.
115         */
116        
117        
118        /*
119        Service code data sets for prevalence (non-fracture outcomes)
120         */
121        %let type = Prev;
122        %let select1 = select A.*, B.enc_type, B.admit_date, B.begin_date, B.discharge_date, B.end_date, B.dx_type, B.dx, B.pdx, "ICD9-DX" as
122      ! codeType, B.dx as code;
123        %let on1 = on (A.patid = B.patid);
124        %let select2 = select A.patid, A.enc_type, A.admit_date, A.begin_date, A.discharge_date, A.end_date, A.dx_type, A.dx, A.pdx;
125        %let where2 = where A.dx_type = "09" & A.enc_type in ("IP", "AV", "ED", "NH", "HH");
126        %let selectfrom3 = select * from DT.controlLookup;
127        
128        %include "lib\buildDxControl.sas";  /* Call script to query ICD-9 diagnosis codes */
NOTE: Table UCB.TEMPLOOKUPMPCDCONTROL created, with 1139225 rows and 9 columns.

NOTE: Table UCB.TEMP0710 created, with 176326981 rows and 9 columns.

NOTE: Table UCB.TEMPPREVDXMPCDCONTROL created, with 94506830 rows and 19 columns.

NOTE: Table UCB.TEMP0710 has been dropped.
NOTE: Table UCB.TEMPLOOKUPMEDICARECONTROL created, with 1844703 rows and 9 columns.

NOTE: Table UCB.TEMP06 created, with 70079498 rows and 9 columns.

NOTE: Table UCB.TEMP07 created, with 71395751 rows and 9 columns.

NOTE: Table UCB.TEMP08 created, with 72901254 rows and 9 columns.

NOTE: Table UCB.TEMP09 created, with 75322391 rows and 9 columns.

NOTE: Table UCB.TEMP10 created, with 82724178 rows and 9 columns.

NOTE: Table UCB.TEMP11 created, with 105073869 rows and 9 columns.

NOTE: Table UCB.TEMP12 created, with 106954237 rows and 9 columns.

NOTE: Table UCB.TEMP13 created, with 111463089 rows and 9 columns.

NOTE: Table UCB.TEMP14 created, with 107440003 rows and 9 columns.

NOTE: Table UCB.TEMPPREVDXSABRCONTROL created, with 450706588 rows and 19 columns.

NOTE: Table UCB.TEMP06 has been dropped.
NOTE: Table UCB.TEMP07 has been dropped.
NOTE: Table UCB.TEMP08 has been dropped.
NOTE: Table UCB.TEMP09 has been dropped.
NOTE: Table UCB.TEMP10 has been dropped.
NOTE: Table UCB.TEMP11 has been dropped.
NOTE: Table UCB.TEMP12 has been dropped.
NOTE: Table UCB.TEMP13 has been dropped.
NOTE: Table UCB.TEMP14 has been dropped.
NOTE: PROCEDURE SQL used (Total process time):
      real time           1:48:28.46
      cpu time            2:01:37.88
      

168        
3                                                                   The SAS System                                   06:48 Tuesday, September 12, 2017

169        %let select1 = select A.*,
170                              B.admit_date, B.begin_date, B.discharge_date, B.end_date, B.px_date, B.px_type, B.px,
171                              case
172                                when B.px_type = "09" then "ICD9-PX"
173                                when B.px_type = "C1" | ^anyalpha(strip(B.px)) then "CPT"
174                                when B.px_type = "H1" & anyalpha(substr(strip(B.px), 1, 1)) & ^anyalpha(strip(B.px), 2) then "HCPCS"
175                                else ""
176                                end as codeType,
177                              B.px as code;
178        %let select2 = select patid, admit_date, begin_date, discharge_date, end_date, px_date, px_type, px;
179        
180        %include "lib\buildPxControl.sas";  /* Call script to query procedure codes */
NOTE: Table UCB.TEMP0710 created, with 346484578 rows and 8 columns.

NOTE: Table UCB.TEMPPREVPXMPCDCONTROL created, with 168458870 rows and 18 columns.

NOTE: Table UCB.TEMP0710 has been dropped.
NOTE: Table UCB.TEMP06 created, with 137802721 rows and 8 columns.

NOTE: Table UCB.TEMP07 created, with 141996458 rows and 8 columns.

NOTE: Table UCB.TEMP08 created, with 147118053 rows and 8 columns.

NOTE: Table UCB.TEMP09 created, with 152579039 rows and 8 columns.

NOTE: Table UCB.TEMP10 created, with 154866267 rows and 8 columns.

NOTE: Table UCB.TEMP11 created, with 157181115 rows and 8 columns.

NOTE: Table UCB.TEMP12 created, with 161224747 rows and 8 columns.

NOTE: Table UCB.TEMP13 created, with 164298030 rows and 8 columns.

NOTE: Table UCB.TEMP14 created, with 166228741 rows and 8 columns.

NOTE: Table UCB.TEMPPREVPXSABRCONTROL created, with 896909634 rows and 18 columns.

NOTE: Table UCB.TEMP06 has been dropped.
NOTE: Table UCB.TEMP07 has been dropped.
NOTE: Table UCB.TEMP08 has been dropped.
NOTE: Table UCB.TEMP09 has been dropped.
NOTE: Table UCB.TEMP10 has been dropped.
NOTE: Table UCB.TEMP11 has been dropped.
NOTE: Table UCB.TEMP12 has been dropped.
NOTE: Table UCB.TEMP13 has been dropped.
NOTE: Table UCB.TEMP14 has been dropped.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3:01:04.00
      cpu time            3:04:24.77
      

218        
219        
220        /*
221        Service code data sets for fracture outcomes
222        Fracture service code data sets are used for both prevalence and incidence;
223        unlike non-fracture service code data sets
224         */
225        %let type = Frac;
226        %let select1 = select A.*,
227                              B.encounterID, B.enc_type, B.admit_date, B.begin_date, B.discharge_date, B.end_date, B.dx_type, B.dx, B.pdx,
227      ! "ICD9-DX" as codeType, B.dx as code,
228                              B.diagCodeType;
229        %let on1 = on (A.patid = B.patid);
230        %let select2 = select A.patid, A.encounterID, A.enc_type, A.admit_date, A.begin_date, A.discharge_date, A.end_date, A.dx_type, A.dx, A.pdx,
231                              case
232                                when '800' <= substr(A.dx, 1, 3) <= '829' or substr(A.dx, 1, 4) = '7331' then "Fracture code"
233                                when substr(A.dx, 1, 4) in ('V541' 'V542') then "Extended care code"
234                                when 'E800' <= substr(A.dx, 1, 4) <= 'E848' or
235                                     'E881' <= substr(A.dx, 1, 4) <= 'E884' or
236                                     'E908' <= substr(A.dx, 1, 4) <= 'E909' or
237                                     'E916' <= substr(A.dx, 1, 4) <= 'E928'
4                                                                   The SAS System                                   06:48 Tuesday, September 12, 2017

238                                  then "Trauma code"
239                                else ""
240                                end as diagCodeType;
241        %let where2 = where A.dx_type = "09" & A.enc_type in ("IP", "AV", "ED", "NH", "HH") & ^missing(calculated diagCodeType);
242        %let selectfrom3 = select * from DT.controlLookup;
243        
244        %include "lib\buildDxControl.sas";  /* Call script to query ICD-9 diagnosis codes */
NOTE: Table UCB.TEMPLOOKUPMPCDCONTROL created, with 1139225 rows and 9 columns.

NOTE: Table UCB.TEMP0710 created, with 1649572 rows and 11 columns.

NOTE: Table UCB.TEMPFRACDXMPCDCONTROL created, with 831426 rows and 21 columns.

NOTE: Table UCB.TEMP0710 has been dropped.
NOTE: Table UCB.TEMPLOOKUPMEDICARECONTROL created, with 1844703 rows and 9 columns.

NOTE: Table UCB.TEMP06 created, with 635901 rows and 11 columns.

NOTE: Table UCB.TEMP07 created, with 641100 rows and 11 columns.

NOTE: Table UCB.TEMP08 created, with 639137 rows and 11 columns.

NOTE: Table UCB.TEMP09 created, with 684664 rows and 11 columns.

NOTE: Table UCB.TEMP10 created, with 840661 rows and 11 columns.

NOTE: Table UCB.TEMP11 created, with 1047155 rows and 11 columns.

NOTE: Table UCB.TEMP12 created, with 1047926 rows and 11 columns.

NOTE: Table UCB.TEMP13 created, with 1076616 rows and 11 columns.

NOTE: Table UCB.TEMP14 created, with 1075778 rows and 11 columns.

NOTE: Table UCB.TEMPFRACDXSABRCONTROL created, with 4531201 rows and 21 columns.

NOTE: Table UCB.TEMP06 has been dropped.
NOTE: Table UCB.TEMP07 has been dropped.
NOTE: Table UCB.TEMP08 has been dropped.
NOTE: Table UCB.TEMP09 has been dropped.
NOTE: Table UCB.TEMP10 has been dropped.
NOTE: Table UCB.TEMP11 has been dropped.
NOTE: Table UCB.TEMP12 has been dropped.
NOTE: Table UCB.TEMP13 has been dropped.
NOTE: Table UCB.TEMP14 has been dropped.
NOTE: PROCEDURE SQL used (Total process time):
      real time           15:09.88
      cpu time            25:38.57
      

284        
285        %let select1 = select A.*,
286                              B.encounterID, B.admit_date, B.begin_date, B.discharge_date, B.end_date, B.px_date, B.px_type, B.px,
287                              case
288                                when B.px_type = "09" then "ICD9-PX"
289                                when B.px_type = "C1" | ^anyalpha(strip(B.px)) then "CPT"
290                                when B.px_type = "H1" & anyalpha(substr(strip(B.px), 1, 1)) & ^anyalpha(strip(B.px), 2) then "HCPCS"
291                                else ""
292                                end as codeType,
293                              B.px as code;
294        %let select2 = select patid, encounterID, admit_date, begin_date, discharge_date, end_date, px_date, px_type, px;
295        
296        %include "lib\buildPxControl.sas";  /* Call script to query procedure codes */
NOTE: Table UCB.TEMP0710 created, with 346484578 rows and 9 columns.

NOTE: Table UCB.TEMPFRACPXMPCDCONTROL created, with 168458870 rows and 19 columns.

NOTE: Table UCB.TEMP0710 has been dropped.
NOTE: Table UCB.TEMP06 created, with 137802721 rows and 9 columns.

NOTE: Table UCB.TEMP07 created, with 141996458 rows and 9 columns.

5                                                                   The SAS System                                   06:48 Tuesday, September 12, 2017

NOTE: Table UCB.TEMP08 created, with 147118053 rows and 9 columns.

NOTE: Table UCB.TEMP09 created, with 152579039 rows and 9 columns.

NOTE: Table UCB.TEMP10 created, with 154866267 rows and 9 columns.

NOTE: Table UCB.TEMP11 created, with 157181115 rows and 9 columns.

NOTE: Table UCB.TEMP12 created, with 161224747 rows and 9 columns.

NOTE: Table UCB.TEMP13 created, with 164298030 rows and 9 columns.

NOTE: Table UCB.TEMP14 created, with 166228741 rows and 9 columns.

NOTE: Table UCB.TEMPFRACPXSABRCONTROL created, with 941591964 rows and 19 columns.

NOTE: Table UCB.TEMP06 has been dropped.
NOTE: Table UCB.TEMP07 has been dropped.
NOTE: Table UCB.TEMP08 has been dropped.
NOTE: Table UCB.TEMP09 has been dropped.
NOTE: Table UCB.TEMP10 has been dropped.
NOTE: Table UCB.TEMP11 has been dropped.
NOTE: Table UCB.TEMP12 has been dropped.
NOTE: Table UCB.TEMP13 has been dropped.
NOTE: Table UCB.TEMP14 has been dropped.
NOTE: PROCEDURE SQL used (Total process time):
      real time           3:28:27.21
      cpu time            3:17:46.01
      

334        
335        
336        
337        
338        ods html close;
NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           8:33:13.09
      cpu time            8:49:27.54
      
