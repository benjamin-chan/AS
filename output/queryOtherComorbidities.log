1                                                          The SAS System                         11:21 Wednesday, November 29, 2017

NOTE: Copyright (c) 2002-2012 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.4 (TS1M1) 
      Licensed to UNIVERSITY OF ALABAMA AT BIRMINGHAM - SFA - T&R, Site 70058223.
NOTE: This session is executing on the W32_ES08R2  platform.



NOTE: Updated analytical products:
      
      SAS/STAT 13.1
      SAS/ETS 13.1
      SAS/OR 13.1
      SAS/IML 13.1
      SAS/QC 13.1

NOTE: Additional host information:

 W32_ES08R2 WIN 6.1.7601 Service Pack 1 Server

--- PEER News and Updates ---

: SECURITY REMINDER :
Please remember not to copy any data files that contain PHI (protected health identifiers) to any of the shared folders.

 


NOTE: SAS initialization used:
      real time           0.20 seconds
      cpu time            0.12 seconds
      
1          *  University of Alabama at Birmingham                               *
2          *  AS project                                            *
3          **********************************************************************;
4          options pagesize=74 linesize=150 pageno=1 missing=' ' date FORMCHAR="|----|+|---+=|-/\<>*";
5          * Programmer    : Benjamin Chan <chanb@ohsu.edu>
6          * Creation date :
7          * Modify date   :
8          ;
9          %let cmt=queryOtherComorbidities; * type the name of your program here (without the filename extension);
10         %let pgm=&cmt..sas;
11         %include "lib\libname.sas" ;
NOTE: Libref STDC5P was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: H:\studies\osteo\data\STD_files\5pct\
NOTE: Libref STD_SABR was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: q:\data\std_SABER\
NOTE: Libref MPSTD was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: h:\studies\mpcd\data\stddata\
NOTE: Libref UCBSTD was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: q:\studies\AS\data\stddata\
NOTE: Libref UCB was successfully assigned as follows: 
      Engine:        SPDE 
      Physical Name: q:\studies\AS\data\UCB\
NOTE: Libref DT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: V:\studies\AS\data
NOTE: Libref NDC was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: W:\onenote\references\drug ndcs\sas data
127        footnote "&pgm.";
128        * footnote2 "%sysfunc(datetime(),datetime14.)";
129        title1 '--- AS project ---';
130        **********************************************************************;
131        options macrogen mlogic mprint symbolgen;
132        options nomacrogen nomlogic nomprint nosymbolgen;
133        
134        
135        ods html
2                                                                   The SAS System                                  11:21 Wednesday, November 29, 2017

136          body = "output\&cmt..html"
137          style = Statistical;
NOTE: Writing HTML Body file: output\queryOtherComorbidities.html
138        
139        
140        
141        
142        proc import out = Work.comorbidityLookup
143                    datafile = "U:\studies\AS\pgms\bchan\data\raw\AS Project Codebooks - 20170410\AS Project Covariates Codebook-20170410.xlsx"
144                    dbms = xlsx
145                    replace;
146          sheet = "Comorbidity";
147          getnames = yes;
148          datarow = 2;
149        run;

NOTE:    Variable Name Change.  Compact Definion -> Compact_Definion                
NOTE: The import data set has 1112 observations and 6 variables.
NOTE: WORK.COMORBIDITYLOOKUP data set was successfully created.
NOTE: PROCEDURE IMPORT used (Total process time):
      real time           0.26 seconds
      cpu time            0.21 seconds
      

150        proc sql;
151          alter table Work.comorbidityLookup
152            add code varchar;
NOTE: Table WORK.COMORBIDITYLOOKUP has been modified, with 7 columns.
153          update Work.comorbidityLookup
154            set code = dequote(icd9_list);
NOTE: 1112 rows were updated in WORK.COMORBIDITYLOOKUP.

155          alter table Work.comorbidityLookup
156            drop compact_definion, icd9_list, billable, description, F;
NOTE: Table WORK.COMORBIDITYLOOKUP has been modified, with 2 columns.
157          delete from Work.comorbidityLookup
158            where missing(code);
NOTE: 1009 rows were deleted from WORK.COMORBIDITYLOOKUP.

159          insert into Work.comorbidityLookup
160            values ("COPD or emphysema", "4910" )
161            values ("COPD or emphysema", "4911" )
162            values ("COPD or emphysema", "49120")
163            values ("COPD or emphysema", "49121")
164            values ("COPD or emphysema", "49122")
165            values ("COPD or emphysema", "4918" )
166            values ("COPD or emphysema", "4919" )
167            values ("COPD or emphysema", "4920" )
168            values ("COPD or emphysema", "4928" )
169            values ("COPD or emphysema", "496"  )
170            values ("COPD or emphysema", "49320")
171            values ("COPD or emphysema", "49321")
172            values ("COPD or emphysema", "49322");
NOTE: 13 rows were inserted into WORK.COMORBIDITYLOOKUP.

173        quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.01 seconds
      

174        
175        
176        proc sql;
177        
178          %let select1 = select A.*, B.comorbidity;
179          %let join1 = inner join Work.comorbidityLookup B on (A.code = B.code);
180          create table DT.comorbiditiesOther as
181            select distinct
182                   C.database, C.exposure, C.patid, C.ASCohortDate, C.indexGNN, C.indexDate, C.indexID,
183                   C.age, C.sex,
184                   C.comorbidity,
3                                                                   The SAS System                                  11:21 Wednesday, November 29, 2017

185                   1 as indPreExposure
186            from (&select1 from UCB.tempPrevDxAll A &join1) C;
NOTE: Parallel WHERE evaluation suppressed due to sort order on table.
NOTE: Table DT.COMORBIDITIESOTHER created, with 75789 rows and 11 columns.

187        
188          select comorbidity, database, exposure, sum(indPreExposure) as sumIndPreExposure
189            from DT.comorbiditiesOther
190            group by comorbidity, database, exposure;
                                                                  --- AS project ---                            11:21 Wednesday, November 29, 2017   1

                                                                                                      sumIndPre
                                       Comorbidity                        database    exposure         Exposure
                                       ------------------------------------------------------------------------
                                       COPD or emphysema                  MPCD        DMARD                  37
                                       COPD or emphysema                  MPCD        NSAID                  63
                                       COPD or emphysema                  MPCD        No exposure           252
                                       COPD or emphysema                  MPCD        TNF                    61
                                       COPD or emphysema                  Marketscan  DMARD                 117
                                       COPD or emphysema                  Marketscan  NSAID                 378
                                       COPD or emphysema                  Marketscan  No exposure           501
                                       COPD or emphysema                  Marketscan  TNF                   259
                                       COPD or emphysema                  Medicare    DMARD                1856
                                       COPD or emphysema                  Medicare    NSAID                4801
                                       COPD or emphysema                  Medicare    No exposure          4641
                                       COPD or emphysema                  Medicare    TNF                  1741
                                       Diabetes                           MPCD        DMARD                  69
                                       Diabetes                           MPCD        NSAID                 121
                                       Diabetes                           MPCD        No exposure           401
                                       Diabetes                           MPCD        TNF                   135
                                       Diabetes                           Marketscan  DMARD                 268
                                       Diabetes                           Marketscan  NSAID                 669
                                       Diabetes                           Marketscan  No exposure           859
                                       Diabetes                           Marketscan  TNF                   636
                                       Diabetes                           Medicare    DMARD                2040
                                       Diabetes                           Medicare    NSAID                5212
                                       Diabetes                           Medicare    No exposure          5191
                                       Diabetes                           Medicare    TNF                  2117
                                       Hypertention                       MPCD        DMARD                 192
                                       Hypertention                       MPCD        NSAID                 359
                                       Hypertention                       MPCD        No exposure           863
                                       Hypertention                       MPCD        TNF                   437
                                       Hypertention                       Marketscan  DMARD                 864
                                       Hypertention                       Marketscan  NSAID                1996
                                       Hypertention                       Marketscan  No exposure          2449
                                       Hypertention                       Marketscan  TNF                  2152
                                       Hypertention                       Medicare    DMARD                4321
                                       Hypertention                       Medicare    NSAID               10763
                                       Hypertention                       Medicare    No exposure         11119
                                       Hypertention                       Medicare    TNF                  4484
                                       Metabolic syndrome                 MPCD        DMARD                   5
                                       Metabolic syndrome                 MPCD        NSAID                  14
                                       Metabolic syndrome                 MPCD        No exposure            21
                                       Metabolic syndrome                 MPCD        TNF                    13
                                       Metabolic syndrome                 Marketscan  DMARD                  43
                                       Metabolic syndrome                 Marketscan  NSAID                  57
                                       Metabolic syndrome                 Marketscan  No exposure            66
                                       Metabolic syndrome                 Marketscan  TNF                    79
                                       Metabolic syndrome                 Medicare    DMARD                 130
                                       Metabolic syndrome                 Medicare    NSAID                 343
                                       Metabolic syndrome                 Medicare    No exposure           228
                                       Metabolic syndrome                 Medicare    TNF                   171
                                       Non-alcoholic fatty liver disease  MPCD        DMARD                   6
                                       Non-alcoholic fatty liver disease  MPCD        NSAID                   9
                                       Non-alcoholic fatty liver disease  MPCD        No exposure            16
                                       Non-alcoholic fatty liver disease  MPCD        TNF                    23
                                       Non-alcoholic fatty liver disease  Marketscan  DMARD                  34
                                       Non-alcoholic fatty liver disease  Marketscan  NSAID                 117
                                       Non-alcoholic fatty liver disease  Marketscan  No exposure           126
                                       Non-alcoholic fatty liver disease  Marketscan  TNF                   168
                                       Non-alcoholic fatty liver disease  Medicare    DMARD                 261
                                       Non-alcoholic fatty liver disease  Medicare    NSAID                 639
                                       Non-alcoholic fatty liver disease  Medicare    No exposure           456
                                       Non-alcoholic fatty liver disease  Medicare    TNF                   340
 
 
 
 
 
 
 
 
                                                             queryOtherComorbidities.sas
191        
192        quit;
NOTE: The PROCEDURE SQL printed page 1.
NOTE: PROCEDURE SQL used (Total process time):
      real time           42.08 seconds
      cpu time            43.74 seconds
      

193        
194        
195        
196        proc sql;
197        /*
198        Oral corticosteroid use
199        Mean outpatient prescribed daily dose of prednisone equivalents in the 6
200        months prior to index date: less than 5 mg/d (low dose), 5 to less than 10
201        mg/d (medium dose), and 10 mg/d or more (high dose)
202         */
203          create table DT.rxOralCorticosteroid as
204            select C.database, C.patid, C.indexID,
205                   1 as indOralCorticosteroid,
206                   sum(C.daysAtRisk * C.prednisodeEquivalentDose) as sumPredEq,
207                   sum(C.daysAtRisk) as sumDaysSupply,
208                   sum(C.daysAtRisk * C.prednisodeEquivalentDose) / 183 as meanPredEqDose,
209                   case
210                     when 0 <= sum(C.daysAtRisk * C.prednisodeEquivalentDose) / 183 < 2.5 then "Low (<2.5 mg/d)"
211                     when 2.5 <= sum(C.daysAtRisk * C.prednisodeEquivalentDose) / 183 < 5 then "Medium-Low (2.5-5 mg/d)"
212                     when 5 <= sum(C.daysAtRisk * C.prednisodeEquivalentDose) / 183 < 10 then "Medium-High (5-10 mg/d)"
213                     when 10 <= sum(C.daysAtRisk * C.prednisodeEquivalentDose) / 183 then "High (10+ mg/d)"
214                     else ""
215                     end as meanPredEqDoseCat
216            from (select A.database, A.patid, A.indexID,
217                         A.indexDate - 183 format = mmddyy10. as riskStart,
218                         A.indexDate,
219                         A.dispense_date,
220                         A.dispense_date + A.dispense_sup - 1 format = mmddyy10. as dispense_end,
221                         A.dispense_sup,
222                         case
223                           /* Rx completely in at-risk period */
224                           when (A.indexDate - 183 <= A.dispense_date) & ((A.dispense_date + A.dispense_sup - 1) <= A.indexDate)
225                             then A.dispense_sup
226                           /* Rx begins before at-risk period */
227                           when (A.dispense_date < A.indexDate - 183)
228                             then A.dispense_sup - (A.indexDate - 183 - A.dispense_date)
229                           /* Rx ends after at-risk period */
230                           when (A.indexDate < (A.dispense_date + A.dispense_sup - 1))
231                             then A.dispense_sup - (A.dispense_date + A.dispense_sup - 1 - A.indexDate)
232                           else .
233                           end as daysAtRisk,
234                         B.prednisodeEquivalentDose
235                  from UCB.tempPrevRxAll A inner join
236                       DT.lookupNDC B on (A.ndc = B.ndc)
237                  where ^missing(B.prednisodeEquivalentDose) &
238                        ((A.indexDate - 183 <= A.dispense_date <= A.indexDate) |
239                          (A.indexDate - 183 <= (A.dispense_date + A.dispense_sup - 1) <= A.indexDate))) C
240            group by C.database, C.patid, C.indexID;
NOTE: Parallel WHERE evaluation suppressed due to sort order on table.
NOTE: Table DT.RXORALCORTICOSTEROID created, with 18717 rows and 8 columns.

241        /*
242        Inhaled antibiotics
243        
244        IS A DAYS-SUPPLY CRITERION REQUIRED??
4                                                                   The SAS System                                  11:21 Wednesday, November 29, 2017

245          create table Work.indInhaledAntibiotics0 as
246            select A.patid, A.episodeID,
247                   A.begin_date format = mmddyy10. as rxDate,
248                   "HCPCS" as codeType,
249                   A.px as drugCode,
250                   "INJECTION" as drugRoute,
251                   B.descript as drugName,
252                   A.px_amt,
253                   . as dispense_sup,
254                   . as dispense_amt
255              from WRK.proccodesHCPCS12mPrior A inner join
256                   DT.lookupJcodes B on (A.px = B.code)
257              where lower(category) = "inhaled antibiotic"
258            union corr
259            select D.patid, D.episodeID,
260                   D.dispense_date format = mmddyy10. as rxDate,
261                   "NDC" as codeType,
262                   E.ndc as drugCode,
263                   D.rt as drugRoute,
264                   D.gnn as drugName,
265                   . as px_amt,
266                   D.dispense_sup,
267                   D.dispense_amt
268              from WRK.rx12mPrior D inner join
269                   DT.lookupNDC E on (D.ndc = E.ndc)
270              where (lower(E.etc_name) like '%antibiotic%' | lower(E.etc_name) like '%polymyxin%') &
271                    lowcase(E.rt) in ("inhalation", "intraven", "injection");
272          select codeType, drugRoute, drugName, count(distinct patid) as countDistinctPatid
273            from Work.indInhaledAntibiotics0
274            group by codeType, drugRoute, drugName;
275          create table Work.indInhaledAntibiotics1 as
276            select distinct
277                   A.patid, A.episodeID,
278                   1 as indInhaledAntibiotics
279            from Work.indInhaledAntibiotics0 A;
280         */
281        quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.24 seconds
      cpu time            2.94 seconds
      

282        
283        
284        
285        
286        ods html close;
NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           46.20 seconds
      cpu time            47.29 seconds
      
